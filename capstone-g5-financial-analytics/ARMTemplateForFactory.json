{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "capstone-g5-financial-analytics"
		},
		"source_db_financial_analytics_password": {
			"type": "secureString",
			"metadata": "Secure string for 'password' of 'source_db_financial_analytics'"
		},
		"source_financial_analytics_db_password": {
			"type": "secureString",
			"metadata": "Secure string for 'password' of 'source_financial_analytics_db'"
		},
		"azure_staging_accountKey": {
			"type": "secureString",
			"metadata": "Secure string for 'accountKey' of 'azure_staging'"
		},
		"source_db_financial_analytics_properties_typeProperties_server": {
			"type": "string",
			"defaultValue": "capstone-financial-analytics-db.cxeikoyuwfyj.us-east-1.rds.amazonaws.com"
		},
		"source_db_financial_analytics_properties_typeProperties_database": {
			"type": "string",
			"defaultValue": "financial_analytics"
		},
		"source_db_financial_analytics_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "admin"
		},
		"source_financial_analytics_db_properties_typeProperties_server": {
			"type": "string",
			"defaultValue": "capstone-financial-analytics-db.cxeikoyuwfyj.us-east-1.rds.amazonaws.com"
		},
		"source_financial_analytics_db_properties_typeProperties_database": {
			"type": "string",
			"defaultValue": "financial_analytics"
		},
		"source_financial_analytics_db_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "admin"
		},
		"azure_staging_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://faiitjgroup5.dfs.core.windows.net/"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/source_db_financial_analytics')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "SqlServer",
				"typeProperties": {
					"server": "[parameters('source_db_financial_analytics_properties_typeProperties_server')]",
					"database": "[parameters('source_db_financial_analytics_properties_typeProperties_database')]",
					"encrypt": "optional",
					"trustServerCertificate": false,
					"authenticationType": "SQL",
					"userName": "[parameters('source_db_financial_analytics_properties_typeProperties_userName')]",
					"password": {
						"type": "SecureString",
						"value": "[parameters('source_db_financial_analytics_password')]"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/source_financial_analytics_db')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "SqlServer",
				"typeProperties": {
					"server": "[parameters('source_financial_analytics_db_properties_typeProperties_server')]",
					"database": "[parameters('source_financial_analytics_db_properties_typeProperties_database')]",
					"encrypt": "optional",
					"trustServerCertificate": false,
					"authenticationType": "SQL",
					"userName": "[parameters('source_financial_analytics_db_properties_typeProperties_userName')]",
					"password": {
						"type": "SecureString",
						"value": "[parameters('source_financial_analytics_db_password')]"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/azure_staging')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('azure_staging_properties_typeProperties_url')]",
					"accountKey": {
						"type": "SecureString",
						"value": "[parameters('azure_staging_accountKey')]"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/adfcdc1')]",
			"type": "Microsoft.DataFactory/factories/adfcdcs",
			"apiVersion": "2018-06-01",
			"properties": {
				"SourceConnectionsInfo": [
					{
						"SourceEntities": [
							{
								"name": "dbo.stock_price_history",
								"properties": {
									"schema": [],
									"dslConnectorProperties": [
										{
											"name": "schemaName",
											"value": "dbo"
										},
										{
											"name": "tableName",
											"value": "stock_price_history"
										},
										{
											"name": "enableCdc",
											"value": true
										},
										{
											"name": "waterMarkColumn",
											"value": "date"
										}
									]
								}
							},
							{
								"name": "dbo.balance_sheet",
								"properties": {
									"schema": [],
									"dslConnectorProperties": [
										{
											"name": "schemaName",
											"value": "dbo"
										},
										{
											"name": "tableName",
											"value": "balance_sheet"
										},
										{
											"name": "enableCdc",
											"value": true
										},
										{
											"name": "waterMarkColumn",
											"value": "date"
										}
									]
								}
							},
							{
								"name": "dbo.cash_flow",
								"properties": {
									"schema": [],
									"dslConnectorProperties": [
										{
											"name": "schemaName",
											"value": "dbo"
										},
										{
											"name": "tableName",
											"value": "cash_flow"
										},
										{
											"name": "enableCdc",
											"value": true
										},
										{
											"name": "waterMarkColumn",
											"value": "date"
										}
									]
								}
							},
							{
								"name": "staging.vw_stock_price_history",
								"properties": {
									"schema": [],
									"dslConnectorProperties": [
										{
											"name": "schemaName",
											"value": "staging"
										},
										{
											"name": "tableName",
											"value": "vw_stock_price_history"
										},
										{
											"name": "enableCdc",
											"value": true
										},
										{
											"name": "waterMarkColumn",
											"value": "formatted_date"
										}
									]
								}
							},
							{
								"name": "staging.vw_income_statement",
								"properties": {
									"schema": [],
									"dslConnectorProperties": [
										{
											"name": "schemaName",
											"value": "staging"
										},
										{
											"name": "tableName",
											"value": "vw_income_statement"
										},
										{
											"name": "enableCdc",
											"value": true
										},
										{
											"name": "waterMarkColumn",
											"value": "date"
										}
									]
								}
							},
							{
								"name": "staging.vw_balance_sheet",
								"properties": {
									"schema": [],
									"dslConnectorProperties": [
										{
											"name": "schemaName",
											"value": "staging"
										},
										{
											"name": "tableName",
											"value": "vw_balance_sheet"
										},
										{
											"name": "enableCdc",
											"value": true
										},
										{
											"name": "waterMarkColumn",
											"value": "formatted_date"
										}
									]
								}
							},
							{
								"name": "staging.vw_cash_flow",
								"properties": {
									"schema": [],
									"dslConnectorProperties": [
										{
											"name": "schemaName",
											"value": "staging"
										},
										{
											"name": "tableName",
											"value": "vw_cash_flow"
										},
										{
											"name": "enableCdc",
											"value": true
										},
										{
											"name": "waterMarkColumn",
											"value": "report_date"
										}
									]
								}
							}
						],
						"Connection": {
							"linkedService": {
								"referenceName": "source_financial_analytics_db",
								"type": "LinkedServiceReference"
							},
							"linkedServiceType": "SqlServer",
							"type": "linkedservicetype",
							"isInlineDataset": true,
							"commonDslConnectorProperties": [
								{
									"name": "allowSchemaDrift",
									"value": true
								},
								{
									"name": "inferDriftedColumnTypes",
									"value": true
								},
								{
									"name": "format",
									"value": "table"
								},
								{
									"name": "store",
									"value": "sqlserver"
								},
								{
									"name": "databaseType",
									"value": "databaseType"
								},
								{
									"name": "database",
									"value": "database"
								},
								{
									"name": "skipInitialLoad",
									"value": true
								}
							]
						}
					}
				],
				"TargetConnectionsInfo": [
					{
						"TargetEntities": [
							{
								"name": "dbo.stock_price_history",
								"properties": {
									"schema": [],
									"dslConnectorProperties": [
										{
											"name": "container",
											"value": "dbo.stock_price_history"
										},
										{
											"name": "fileSystem",
											"value": "dbo.stock_price_history"
										}
									]
								}
							},
							{
								"name": "dbo.balance_sheet",
								"properties": {
									"schema": [],
									"dslConnectorProperties": [
										{
											"name": "container",
											"value": "dbo.balance_sheet"
										},
										{
											"name": "fileSystem",
											"value": "dbo.balance_sheet"
										}
									]
								}
							},
							{
								"name": "dbo.cash_flow",
								"properties": {
									"schema": [],
									"dslConnectorProperties": [
										{
											"name": "container",
											"value": "dbo.cash_flow"
										},
										{
											"name": "fileSystem",
											"value": "dbo.cash_flow"
										}
									]
								}
							},
							{
								"name": "staging.vw_stock_price_history",
								"properties": {
									"schema": [],
									"dslConnectorProperties": [
										{
											"name": "container",
											"value": "staging.vw_stock_price_history"
										},
										{
											"name": "fileSystem",
											"value": "staging.vw_stock_price_history"
										}
									]
								}
							},
							{
								"name": "staging.vw_income_statement",
								"properties": {
									"schema": [],
									"dslConnectorProperties": [
										{
											"name": "container",
											"value": "staging.vw_income_statement"
										},
										{
											"name": "fileSystem",
											"value": "staging.vw_income_statement"
										}
									]
								}
							},
							{
								"name": "staging.vw_balance_sheet",
								"properties": {
									"schema": [],
									"dslConnectorProperties": [
										{
											"name": "container",
											"value": "staging.vw_balance_sheet"
										},
										{
											"name": "fileSystem",
											"value": "staging.vw_balance_sheet"
										}
									]
								}
							},
							{
								"name": "staging.vw_cash_flow",
								"properties": {
									"schema": [],
									"dslConnectorProperties": [
										{
											"name": "container",
											"value": "staging.vw_cash_flow"
										},
										{
											"name": "fileSystem",
											"value": "staging.vw_cash_flow"
										}
									]
								}
							}
						],
						"Connection": {
							"linkedService": {
								"referenceName": "azure_staging",
								"type": "LinkedServiceReference"
							},
							"linkedServiceType": "AzureBlobFS",
							"type": "linkedservicetype",
							"isInlineDataset": true,
							"commonDslConnectorProperties": [
								{
									"name": "allowSchemaDrift",
									"value": true
								},
								{
									"name": "inferDriftedColumnTypes",
									"value": true
								},
								{
									"name": "format",
									"value": "parquet"
								}
							]
						},
						"DataMapperMappings": [
							{
								"targetEntityName": "dbo.balance_sheet",
								"sourceEntityName": "dbo.balance_sheet",
								"sourceConnectionReference": {
									"connectionName": "source_financial_analytics_db",
									"type": "linkedservicetype"
								},
								"attributeMappingInfo": {
									"attributeMappings": []
								}
							},
							{
								"targetEntityName": "dbo.cash_flow",
								"sourceEntityName": "dbo.cash_flow",
								"sourceConnectionReference": {
									"connectionName": "source_financial_analytics_db",
									"type": "linkedservicetype"
								},
								"attributeMappingInfo": {
									"attributeMappings": []
								}
							},
							{
								"targetEntityName": "dbo.stock_price_history",
								"sourceEntityName": "dbo.stock_price_history",
								"sourceConnectionReference": {
									"connectionName": "source_financial_analytics_db",
									"type": "linkedservicetype"
								},
								"attributeMappingInfo": {
									"attributeMappings": []
								}
							},
							{
								"targetEntityName": "staging.vw_balance_sheet",
								"sourceEntityName": "staging.vw_balance_sheet",
								"sourceConnectionReference": {
									"connectionName": "source_financial_analytics_db",
									"type": "linkedservicetype"
								},
								"attributeMappingInfo": {
									"attributeMappings": []
								}
							},
							{
								"targetEntityName": "staging.vw_cash_flow",
								"sourceEntityName": "staging.vw_cash_flow",
								"sourceConnectionReference": {
									"connectionName": "source_financial_analytics_db",
									"type": "linkedservicetype"
								},
								"attributeMappingInfo": {
									"attributeMappings": []
								}
							},
							{
								"targetEntityName": "staging.vw_income_statement",
								"sourceEntityName": "staging.vw_income_statement",
								"sourceConnectionReference": {
									"connectionName": "source_financial_analytics_db",
									"type": "linkedservicetype"
								},
								"attributeMappingInfo": {
									"attributeMappings": []
								}
							},
							{
								"targetEntityName": "staging.vw_stock_price_history",
								"sourceEntityName": "staging.vw_stock_price_history",
								"sourceConnectionReference": {
									"connectionName": "source_financial_analytics_db",
									"type": "linkedservicetype"
								},
								"attributeMappingInfo": {
									"attributeMappings": []
								}
							}
						],
						"Relationships": []
					}
				],
				"Policy": {
					"recurrence": {
						"frequency": "Minute",
						"interval": 15
					},
					"mode": "Microbatch"
				},
				"allowVNetOverride": false
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/source_financial_analytics_db')]",
				"[concat(variables('factoryId'), '/linkedServices/azure_staging')]"
			]
		}
	]
}